<!DOCTYPE html>
<html>
  <!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  
  <title>约数 - Red</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  
  <meta name="keywords" content=算法学习笔记,数论>
  
  
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.02">
  
  
    <link rel="alternate" href="/atom.xml " title="Red" type="application/atom+xml">
  

  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>
  <body>
    <div class="container">
      <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">Red</a>
    <div class="subtitle"></div>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">Home</a>
        </li>
      
        <li class="menu-item">
          <a href="/archives" class="menu-item-link">Archives</a>
        </li>
      
    </ul>
  </nav>
</header>
<article class="post">
  <div class="post-title">
    <h1 class="article-title">约数</h1>
  </div>
   <div class="post-meta">
    <span class="post-time">2021-11-09</span>
  </div>
  <div class="post-content">
    <p>求某数的约数、某数约数的个数、约数之和、最大公约数。</p>
<span id="more"></span>

<h1 id="求某数的所有约数——试除法"><a href="#求某数的所有约数——试除法" class="headerlink" title="求某数的所有约数——试除法"></a>求某数的所有约数——试除法</h1><p>若只是单纯打暴力从 2 枚举到 n 肯定是不行的，那么怎么去优化？</p>
<ul>
<li><p>首先可以知道，如果<code>n % i == 0</code>，那么<code>n % (n / i) == 0</code>，所以只要枚举那个较小的约数即可，即<code>i &lt;= n / i</code>。</p>
</li>
<li><p>除此之外，还有一个边界条件需要判断，当<code>i * i == n</code> 时，会多放一个 i 进去，所以需要加上一个判断条件<code>if(i != x / i)</code>。</p>
</li>
</ul>
<p>时间复杂度：$O(sqrt(n)*\log n \log {\log n})≈O(sqrt(n))$  左式如何得出来的呢？</p>
<p>首先每次循环需要$sqrt(n)$，然后是对所有约数的排序，求 n 中约数的个数有一种办法：</p>
<p>对于 1，它的倍数是$n&#x2F;1$个；</p>
<p>对于 2，它的倍数是$n&#x2F;2$个；</p>
<p>……</p>
<p>显然可以得知<strong>一个数</strong>是<strong>这个数</strong>所有倍数的约数，显然在 1 - n 中，所有数的倍数之和是 $\frac{n}{1} + \frac{n}{2} + \frac{n}{5} + … + \frac{n}{n}&lt; n\log n$，平均到每一个数上，那么每一个数的约数约等于 $\log n$（相当于求期望）。n 个数 sort 的时间复杂度为 $n \log n$，所以 $\log n$ 个约数就是 $\log n \log \log n$。而这个数是非常小的，所以算时间复杂度的的时候直接算$O(sqrt(n))$。</p>
<h2 id="869-试除法求约数"><a href="#869-试除法求约数" class="headerlink" title="869. 试除法求约数"></a><a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/871/">869. 试除法求约数</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">get_divisors</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= x / i; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(x % i == <span class="number">0</span>)&#123;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(i); </span><br><span class="line">            <span class="keyword">if</span>(i != x / i) ans.<span class="built_in">push_back</span>(x / i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span>(n --)&#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        <span class="keyword">auto</span> t = <span class="built_in">get_divisors</span>(x);</span><br><span class="line">        <span class="built_in">sort</span>(t.<span class="built_in">begin</span>(), t.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> i: t) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="求某数约数的个数"><a href="#求某数约数的个数" class="headerlink" title="求某数约数的个数"></a>求某数约数的个数</h1><p>对于某个正整数 $n$，可知：$n&#x3D;p_1^{α_1}+p_2^{α_2}+…+p_k^{α_k}$</p>
<p>所以某一个小于等于$n$的约数可以表示为：$d&#x3D;p_1^{β_1}+p_2^{β_2}+…+p_k^{β_k}$</p>
<p>其中$p_1,p_2,…,p_k$是$n$的质因子，且$0≤β_i≤α_i$。</p>
<p>所以根据乘法原理，$n$的约数一共有$(α_1+1)(α_2+1)…(α_3+1)$个。</p>
<h2 id="870-约数个数"><a href="#870-约数个数" class="headerlink" title="870. 约数个数"></a><a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/872/">870. 约数个数</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long int</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; primes;</span><br><span class="line">    <span class="keyword">while</span>(n --)&#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= x / i; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(x % i == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">while</span>(x % i == <span class="number">0</span>)&#123;</span><br><span class="line">                    x /= i;</span><br><span class="line">                    primes[i] ++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(x &gt; <span class="number">1</span>) primes[x] ++;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> i: primes)&#123;</span><br><span class="line">        ans = (ans * (i.second + <span class="number">1</span>) % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="求某数的约数之和"><a href="#求某数的约数之和" class="headerlink" title="求某数的约数之和"></a>求某数的约数之和</h1><p>根据上面求约数的个数定理：</p>
<p>约数之和 &#x3D; $(p_1^0+p_1^1+…+p_1^{α_1})(p_2^0+p_2^1+…+p_2^{α_2})…(p_n^0+p_n^1+…+p_n^{α_n})$</p>
<h2 id="871-约数之和"><a href="#871-约数之和" class="headerlink" title="871. 约数之和"></a><a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/873/">871. 约数之和</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long int</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; primes;</span><br><span class="line">    <span class="keyword">while</span>(n --)&#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= x / i; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(x % i == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">while</span>(x % i == <span class="number">0</span>)&#123;</span><br><span class="line">                    x /= i;</span><br><span class="line">                    primes[i] ++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(x &gt; <span class="number">1</span>) primes[x] ++;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> i: primes)&#123;</span><br><span class="line">        ll res = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> a = i.first, b = i.second;</span><br><span class="line">        <span class="keyword">while</span>(b --) res = (res * a % mod + <span class="number">1</span>) % mod;</span><br><span class="line">        ans = ans * res % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="欧几里得算法"><a href="#欧几里得算法" class="headerlink" title="欧几里得算法"></a>欧几里得算法</h1><p>首先介绍一些基本性质：</p>
<ul>
<li><p>一：若 $d|a$ 且 $d|b$，那么 $d|(a+b)$，$d|(ax+by)$。</p>
</li>
<li><p>二：$(a,b)&#x3D;(b,a\mod b)$ 证明如下：</p>
<p>$a\mod b &#x3D; a - [\frac{a}{b}]*b &#x3D; a-cb$</p>
<ul>
<li>先证左边的所有公约数都是右边的公约数：由于$(a,b)$，那么一定满足 $a$ 和 $b$ 的公约数 $d|a$，$d|b$，根据性质一，可知 $d|(a-cb)$，所以 $a$ 和 $b$ 的公约数全部都是 $b$ 和 $(a - cb)$ 的公约数。</li>
<li>再证右边的所有公约数都是左边的公约数：由于$(b,a-cb)$，那么满足 $a$ 和 $a-cb$ 的公约数 $d|b$，$d|(a-cb)$，再用性质一得$d|(a-cb+cb)&#x3D;d|a$，所以 $b$ 和 $(a - cb)$ 的公约数全部都是 $a$ 和 $b$ 的公约数。</li>
<li>所以左右两边的公约数相同，那么其最大公约数也相同。</li>
</ul>
</li>
</ul>
<p>下面求最大公约数用的就是欧几里得算法，时间复杂度$O(logn)$</p>
<h2 id="872-最大公约数"><a href="#872-最大公约数" class="headerlink" title="872. 最大公约数"></a><a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/874/">872. 最大公约数</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b?<span class="built_in">gcd</span>(b, a % b) : a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span>(n --)&#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">gcd</span>(a, b) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


  </div>
  <div class="post-footer">
    
      <ul class="post-tag-list" itemprop="keywords"><li class="post-tag-list-item"><a class="post-tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a></li><li class="post-tag-list-item"><a class="post-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">算法学习笔记</a></li></ul>
    

    <a href="#top" class="top">Back to Top</a>
  </div>
</article>
<footer>
  &copy; 2022
  <span class="author">
    red
  </span>
</footer>
    </div>
  </body>
</html>